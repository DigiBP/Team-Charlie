<!DOCTYPE html>
<html>

<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    

</head>

<body>
    <div class="container pt-3">
        <h1 class="display-4">Digital Pharmacy</h1>
        <p class="lead">Online booking form for your favorite pharmacy</p>
        </section>
        <div class="form-group">
            <label for="exampleInputEmail1" class="fw-bold">Drugs:</label>
            <select id="drugs-select" class="form-control" name="drugs" multiple></select>
        </div>
        <button id="send-button" class="btn btn-primary mt-3">Submit</button>
    </div>

    <script>
        fetch("https://api.airtable.com/v0/appqK2pLyymq6q5If/Drug?api_key=keyd1QZAa1OCVYSgU").then(function (response) {
            return response.json();
        }).then(function (data) {
            let options = [];
            let selectObj = document.getElementById('drugs-select');
            for (let i = 0; i < data.records.length; i++) {
                var opt = data.records[i].fields;
                var el = document.createElement("option");
                el.textContent = opt.Name;
                el.value = opt.Id;
                selectObj.appendChild(el);
                options.push(data.records[i].fields.Name);
            }
        }).catch(function () {
            alert("There has been an error while connecting airtable. Please try again later.");
        });

        (function (window, document, undefined) {


            document.getElementById("send-button").addEventListener("click", function () {
                alert(getSelectValues(document.getElementById('drugs-select')));
            });

            function getSelectValues(select) {
                var result = [];
                var options = select && select.options;
                var opt;

                for (var i = 0, iLen = options.length; i < iLen; i++) {
                    opt = options[i];

                    if (opt.selected) {
                        result.push(opt.value || opt.text);
                    }
                }
                return result;
            }
        })(window, document, undefined);
    </script>
</body>

</html>